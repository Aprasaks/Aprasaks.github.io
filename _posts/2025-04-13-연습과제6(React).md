---
layout: single
toc: true
tag: [react, ì»¤ìŠ¤í…€í›…]
categories: ReactProject
sidebar:
  nav: "counts"
---

ê°„ë‹¨í•œ ì—°ìŠµë¬¸ì œë¡œ ë°°ìš´ ê°œë…ì„ í•˜ë‚˜ì”© ì •ë¦¬í•´ë³´ì.



# ë¬¸ì œ

---

```jsx
//App.jsx
import './App.css';
import useFetch from './useFetch';

const dogUrl = 'https://dog.ceo/api/breeds/image/random';

const catUrl = 'https://api.thecatapi.com/v1/images/search';

function App() {
  
  const {
    data: dogData,
    loading: dogLoading,
    fetchData: dogFetchData,
  } = useFetch(dogUrl);

  const {
    data: catData,
    loading: catLoading,
    fetchData: catFetchData,
  } = useFetch(catUrl);
  return (
    <>
      <h1> Animal gallery</h1>
      <p>
        ì• ë‹ˆë©€ ê°¤ëŸ¬ë¦¬ì— ì˜¤ì‹  ì—¬ëŸ¬ë¶„ í™˜ì˜í•©ë‹ˆë‹¤. <br /> ê° ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚¬ì§„ì„
        ì—…ë°ì´íŠ¸ í•´ë³´ì„¸ìš”.
      </p>
      <div className="container">
        <h2> ğŸ¶ Dog Zone</h2>
      
        <button onClick={() => dogFetchData(dogUrl)}>new Dog</button>
        {dogLoading ? (
          <p className="loading">Loading . . .</p>
        ) : (
          dogData && <img src={dogData.message} alt="dog" />
        )}
      </div>
      <div className="container">
        <h2>ğŸ±Cat Zone</h2>
       
        <button onClick={() => catFetchData(catUrl)}>new Cat</button>
        {catLoading ? (
          <p className="loading">Loading . . .</p>
        ) : (
          catData && <img src={catData[0].url} alt="cat" />
        )}
      </div>
    </>
  );
}

export default App;
```

```jsx
//useFetch.jsx
import { useEffect, useState } from 'react';


const useFetch = (url) => {
 
  const [data, setData] = useState();
  const [loading, setLoading] = useState();
  const [error, setError] = useState();
  const fetchData = () => {
  
  
    fetch();
  };
 
  useEffect(() => {});
  
  return {};
};
export default useFetch;
```

ë¬¸ì œë¶€í„° ì´í•´í•˜ê³  ë„˜ì–´ê°€ì. 

"Animal gallery" ë¼ëŠ” ë™ë¬¼ ì‚¬ì§„ ê°¤ëŸ¬ë¦¬ë¥¼ ë§Œë“œëŠ” ë¬¸ì œì´ë‹¤. 

ê°ê° ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ê°•ì•„ì§€ì™€ ê³ ì–‘ì´ ì‚¬ì§„ì„ ì œê³µí•˜ëŠ” ì˜¤í”ˆ API ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒˆë¡± ì‚¬ì§„ì„ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œì´ë‹¤.

ìš”êµ¬ì‚¬í•­ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ì.

<useFetch.jsx>

1. data, loading, error ê°’ì— ëŒ€í•œ ì´ˆê¸° ê°’ì„ ì§€ì •í•˜ì„¸ìš”.
2. ë¡œë”© ìƒíƒœë¥¼ trueë¡œ ë³€ê²½í•©ë‹ˆë‹¤. ( ë°ì´í„° íŒ¨ì¹­ ì „ ë¡œë”© ì ìš© )
3. fetch ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìë¡œ ë°›ì€ urlì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ data ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•´ì£¼ì„¸ìš”.
4. ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í–ˆë‹¤ë©´, ìƒíƒœë¥¼ ë‹¤ì‹œ falseë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.
5. catchë¬¸ì„ ì‚¬ìš©í•˜ì—¬ error ìƒíƒœê°’ì„ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ í•¸ë“¤ë§ ì½”ë“œë„ í•¨ê»˜ ì‘ì„±í•´ì£¼ì„¸ìš”.
6. useEffectë¥¼ ì‚¬ìš©í•˜ì—¬ urlì´ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ë§Œ fetchData í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ ì‘ì„±í•˜ì„¸ìš”.
7. returnë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì´ 3ê°€ì§€ì˜ ìƒíƒœ ê°’ê³¼ fetchData í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ì„¸ìš”.

ìš”êµ¬ì‚¬í•­ì´ ë­”ê°€ ê¸¸ê³  ë³µì¡í•´ë³´ì¸ë‹¤. í•˜ì§€ë§Œ í•˜ë‚˜ì”© í•´ê²°í•˜ë©´ ê¸ˆë°© í•  ìˆ˜ ìˆì„ë“¯ í•˜ë‹ˆ í•˜ë‚˜ì”© í•´ê²°í•´ë³´ì.



# ì •ë‹µ

---

## ì •ë‹µ1.1

ì²«ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ data, loading, errorê°’ì— ëŒ€í•œ ì´ˆê¸°ê°’ ì§€ì •ì€

nullê³¼ falseë¥¼ ì´ìš©í•œë‹¤.

dataëŠ” APIì—ì„œ ë°›ì•„ì˜¬ ë°ì´í„°ì˜ ì´ˆê¸°ê°’ì´ë©° ì•„ì§ ë°›ì•„ì˜¤ì§€ì•Šì•˜ìœ¼ë¯€ë¡œ ì •ì˜ë˜ì§€ì•ŠìŒì´ ì•„ë‹Œ ì—†ìŒì˜ nullë¡œ ì´ˆê¸°í™”í•œë‹¤.
loadingì€ ë°ì´í„° íŒ¨ì¹­ ì‘ì—…ì˜ ì§„í–‰ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ë©° booleanê°’ì´ë‹¤.

fetchìš”ì²­ ì „ì´ë¯€ë¡œ falseë¡œ ì´ˆê¸°í™”í•œë‹¤.

error ëŠ” API í˜¸ì¶œ ì¤‘ì— ë°œìƒí•œ ì—ëŸ¬ë¥¼ ì €ì¥í•  ë³€ìˆ˜ì´ë©° 

ì•„ì§ ì—ëŸ¬ê°€ ì—†ìœ¼ë¯€ë¡œ nullë¡œ ì´ˆê¸°í™”í•œë‹¤.

```jsx 
const [data, setData] = useState(null);
const [loading, setLoading] = useState(false);
const [error, setError] = useState(null);
```



## ì •ë‹µ1.2

ë‘ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ì€ ë¡œë”©ìƒíƒœë¥¼ trueë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤.

ë‹¤ì‹œë§í•´ ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê¸° ë°”ë¡œ ì „ì— loadingìƒíƒœë¥¼ `true`ë¡œ ì„¤ì •í•œë‹¤.

```jsx
const fetchData = () => {
  setLoading(true);
  
};
```



## ì •ë‹µ1.3

ì„¸ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ì€ fetch ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ìë¡œ ë°›ì€ urlì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ data ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì´ë‹¤.

```jsx
const fetchData = (fetchUrl) => {
    // ì „ë‹¬ë°›ì€ fetchUrl(ë˜ëŠ” ê¸°ë³¸ url)ì„ ì‚¬ìš©
    const requestUrl = fetchUrl || url;
    
    // ë¡œë”© ìƒíƒœ true
    setLoading(true);

    // fetch ìš”ì²­ ë° ê²°ê³¼ ì²˜ë¦¬
    fetch(requestUrl)
      .then((response) => {
        // HTTP ì‘ë‹µ ìƒíƒœ ì²´í¬
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        // ì‘ë‹µ JSON íŒŒì‹±
        return response.json();
      })
      .then((result) => {
        // result ê°’ì„ ë°ì´í„° ìƒíƒœì— ì—…ë°ì´íŠ¸
        setData(result);
        // ì—ëŸ¬ëŠ” ì •ìƒ ì‘ë‹µ ì‹œ nullë¡œ ì´ˆê¸°í™”
        setError(null);
      })
      // ì´í›„ catchì™€ finallyë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚˜ë¨¸ì§€ ìš”êµ¬ì‚¬í•­ ì²˜ë¦¬
  };
```

`fetch(requestUrl)`ë¡œ API í˜¸ì¶œì„ ì‹œì‘í•œë‹¤.

ì‘ë‹µì´ ì •ìƒì ì´ì§€ ì•Šìœ¼ë©´ Errorë¥¼ ë°œìƒì‹œí‚¤ê³ , ì •ìƒì¼ ê²½ìš° JSON ë°ì´í„°ë¥¼ **data** ìƒíƒœë¡œ ì—…ë°ì´íŠ¸í•œë‹¤.

## ì •ë‹µ1.4

ë„¤ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ì€ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ í›„ì— ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í–ˆë‹¤ë©´, ìƒíƒœë¥¼ ë‹¤ì‹œ falseë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤.

ë°ì´í„° ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤ë©´, loadingìƒíƒœë¥¼ falseë¡œ ëŒë¦¬ë©´ ëœë‹¤.

```jsx
.finally(() =>{
  setLoading(false);
});
```

`.finally()`ì€ ìš”ì²­ì„±ê³µ,ì‹¤íŒ¨ ì—¬ë¶€ì— ìƒê´€ì—†ì´ ë§ˆì§€ë§‰ì— ì‹¤í–‰ëœë‹¤.

## ì •ë‹µ1.5

catchë¬¸ì„ ì‚¬ìš©í•˜ì—¬ error ìƒíƒœê°’ì„ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ í•¸ë“œë§ ì½”ë“œë„ í•¨ê»˜ ì‘ì„±í•´ë‹¬ë¼ëŠ” ê²ƒì´ ë‹¤ì„¯ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ì´ë‹¤.

ì´ì— ë°ì´í„° ìš”ì²­ ì¤‘ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ `catch()`ë¸”ë¡ì—ì„œ ì´ë¥¼ ì²˜ë¦¬í•˜ê³ , error ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤.

```jsx
.catch((err) => {
  setError(err.message);
  setData(null);
})
```

## ì •ë‹µ1.6

useEffectë¥¼ ì‚¬ìš©í•˜ì—¬ urlì´ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ë§Œ fetchData í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ ì‘ì„±í•˜ì„¸ìš” ê°€ ì—¬ì„¯ë²ˆì§¸ ìš”êµ¬ì‚¬í•­ì´ë‹¤.

ì´ë¥¼ ìœ„í•´ ì²« ë Œë”ë§ ë°‘ url ê°’ì´ ë³€ê²½ë  ë•Œë§Œ ìë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìš”ì²­í•  ê²ƒì´ê³  useEffectì˜ ì˜ì¡´ì„± ë°°ì—´ì— urlì„ ë„£ì„ ê²ƒì´ë‹¤.

```jsx 
useEffect(() => {
  if (url) {
    fetchData(url);
  }
}, [url]);
```



## ì •ë‹µ1.7

ë§ˆì§€ë§‰ ìš”êµ¬ì‚¬í•­ì€ returnë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ 3ê°€ì§€ì˜ ìƒíƒœ ê°’ê³¼ fetchData í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ë¼ëŠ” ê²ƒì´ë‹¤.

```jsx
import { useEffect, useState } from 'react';

const useFetch = (url) => {
  // 1. ì´ˆê¸°ê°’ ì§€ì •
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  // 2 ~ 5. fetchData í•¨ìˆ˜ êµ¬í˜„
  const fetchData = (fetchUrl) => {
    const requestUrl = fetchUrl || url;
    setLoading(true);
    fetch(requestUrl)
      .then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then((result) => {
        setData(result);
        setError(null);
      })
      .catch((err) => {
        setError(err.message);
        setData(null);
      })
      .finally(() => {
        setLoading(false);
      });
  };

  // 6. useEffectë¡œ url ë³€ê²½ ê°ì§€
  useEffect(() => {
    if (url) {
      fetchData(url);
    }
  }, [url]);

  // 7. data, loading, error, fetchData ë¦¬í„´
  return { data, loading, error, fetchData };
};

export default useFetch;
```



# ì •ë¦¬

---

ì´ë²ˆ ê³¼ì œëŠ” ì§„ì§œ ì–´ë ¤ì› ë‹¤. 

í•´ì„ì„ í•˜ë©´ì„œë„ ë¬´ìŠ¨ ë§ì¸ì§€ë„ ëª¨ë¥´ëŠ” ë‚´ìš©ì´ ë„ˆë¬´ë§ê³  

ì½”ë“œë¥¼ ì‘ì„±í–ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì´í•´ê°€ ì•ˆê°€ëŠ” ë¶€ë¶„ì´ ë„ˆë¬´ ë§ë‹¤.

ë‹¤ì‹œ ë³µìŠµí•˜ê³  í•´ì„í•˜ê³  ë‹¤ì‹œ ì§œë´ì•¼ê² ë‹¤.





